{
  "paragraphs": [
    {
      "text": "%md\n## Variable-Length Paths\n\nThis tutorial shows how to find **shortest paths** and **cheapest paths**, as well as how **horizontal aggregation** works.\n\nPlease visit [the relevant section in pgql-lang.org](https://pgql-lang.org/spec/1.3/#variable-length-paths) for more details.\n\n![](https://user-images.githubusercontent.com/4862919/88672488-7cbbd800-d122-11ea-9a9f-12302837cf92.jpg)",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:26.159",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eVariable-Length Paths\u003c/h2\u003e\n\u003cp\u003eThis tutorial shows how to find \u003cstrong\u003eshortest paths\u003c/strong\u003e and \u003cstrong\u003echeapest paths\u003c/strong\u003e, as well as how \u003cstrong\u003ehorizontal aggregation\u003c/strong\u003e works.\u003c/p\u003e\n\u003cp\u003ePlease visit \u003ca href\u003d\"https://pgql-lang.org/spec/1.3/#variable-length-paths\"\u003ethe relevant section in pgql-lang.org\u003c/a\u003e for more details.\u003c/p\u003e\n\u003cp\u003e\u003cimg src\u003d\"https://user-images.githubusercontent.com/4862919/88672488-7cbbd800-d122-11ea-9a9f-12302837cf92.jpg\" /\u003e\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595943157208_1455213789",
      "id": "20200303-214034_1675571787",
      "dateCreated": "2020-07-28 13:32:37.209",
      "dateStarted": "2020-07-30 00:16:26.246",
      "dateFinished": "2020-07-30 00:16:26.291",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Load graph",
      "text": "%pgx\ngraph \u003d session.readGraphWithProperties(\"/graphs/pgql_financial/config.json\")",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:26.343",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "PgxGraph[name\u003dFinancial Transactions_2,N\u003d8,E\u003d10,created\u003d1596014912068]"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595943157229_-1573905017",
      "id": "20200728-114724_335653543",
      "dateCreated": "2020-07-28 13:32:37.229",
      "dateStarted": "2020-07-30 00:16:26.520",
      "dateFinished": "2020-07-30 00:16:26.978",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Quantifiers",
      "text": "%pgx\n// Find a shortest path from account 10039 to account 2090, following only transaction edges\ngraph.queryPgql(\"\"\"\nSELECT a.number AS a,\n       b.number AS b,\n       COUNT(e) AS pathLength,\n       ARRAY_AGG(e.amount) AS amounts\n  FROM MATCH SHORTEST ( (a:Account) -[e:transaction]-\u003e* (b:Account) )\n WHERE a.number \u003d 10039 AND b.number \u003d 2090\n\"\"\");",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:27.022",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 84.78125,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "a": "string",
                      "b": "string",
                      "pathLength": "string",
                      "amounts": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "a\tb\tpathLength\tamounts\n10039\t2090\t3\t[1000.0, 1500.3, 9999.5]"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595943157249_-273805242",
      "id": "20200302-212041_1026051053",
      "dateCreated": "2020-07-28 13:32:37.249",
      "dateStarted": "2020-07-30 00:16:27.151",
      "dateFinished": "2020-07-30 00:16:27.561",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Horizontal aggregation using group variables",
      "text": "%pgx\n// Find the shortest paths from 10039 to two accounts, 1001 and 2090, then return the sum of the path lengths\ngraph.queryPgql(\"\"\"\nSELECT SUM(COUNT(e)) AS sumOfPathLengths\n  FROM MATCH SHORTEST ( (a:Account) -[e:transaction]-\u003e* (b:Account) )\n WHERE a.number \u003d 10039 AND (b.number \u003d 1001 OR b.number \u003d 2090)\n\"\"\");",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:27.656",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 92.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "sumOfPathLengths": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "sumOfPathLengths\n5"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595943157249_2112880173",
      "id": "20200303-211616_495605545",
      "dateCreated": "2020-07-28 13:32:37.249",
      "dateStarted": "2020-07-30 00:16:27.856",
      "dateFinished": "2020-07-30 00:16:28.788",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Horizontal aggregation in WHERE",
      "text": "%pgx\n// Find the shortest paths from 10039 to three accounts, 8021, 1001, and 2090, then return the paths whose lengths are equal of smaller than 2\ngraph.queryPgql(\"\"\"\n  SELECT b.number AS b,\n         COUNT(e) AS pathLength,\n         ARRAY_AGG(e.amount) AS transactions\n    FROM MATCH SHORTEST ( (a:Account) -[e:transaction]-\u003e* (b:Account) )\n   WHERE a.number \u003d 10039 AND\n         (b.number \u003d 8021 OR b.number \u003d 1001 OR b.number \u003d 2090) AND\n         COUNT(e) \u003c\u003d 2\nORDER BY pathLength\n\"\"\");",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:28.832",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 108.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "b": "string",
                      "pathLength": "string",
                      "transactions": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "b\tpathLength\ttransactions\n8021\t1\t[1000.0]\n1001\t2\t[1000.0, 1500.3]"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595943157250_-1387238200",
      "id": "20200303-223141_283396721",
      "dateCreated": "2020-07-28 13:32:37.250",
      "dateStarted": "2020-07-30 00:16:29.002",
      "dateFinished": "2020-07-30 00:16:31.310",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Horizontal aggregation in GROUP BY",
      "text": "%pgx\n// Find the 4 shortest paths in the combinations of accounts, and aggregate and sort by the path lengths\ngraph.queryPgql(\"\"\"\n  SELECT COUNT(e) AS pathLength,\n         COUNT(*) AS cnt\n    FROM MATCH SHORTEST ( (a:Account) -[e:transaction]-\u003e* (b:Account) )\n   WHERE (a.number \u003d 10039 OR a.number \u003d 8021) AND\n         (b.number \u003d 1001 OR b.number \u003d 2090)\nGROUP BY COUNT(e)\nORDER BY pathLength\n\"\"\");",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:31.320",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 168.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "pathLength": "string",
                      "cnt": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "pathLength\tcnt\n1\t1\n2\t2\n3\t1"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595943157250_1817643748",
      "id": "20200728-121529_1649623286",
      "dateCreated": "2020-07-28 13:32:37.250",
      "dateStarted": "2020-07-30 00:16:31.446",
      "dateFinished": "2020-07-30 00:16:33.316",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Single Shortest Path",
      "text": "%pgx\n// Return the account number or person\u0027s name of the nodes on the path\ngraph.queryPgql(\"\"\"\n  SELECT COUNT(e) AS num_hops\n       , p1.name AS start\n       , ARRAY_AGG ( CASE\n                       WHEN has_label(dst, \u0027Account\u0027)\n                         THEN CAST(dst.number AS STRING)\n                       ELSE dst.name\n                     END\n                   ) AS path\n    FROM MATCH SHORTEST ( (p1:Person) (-[e]- (dst))* (p2:Person) )\n   WHERE p1.name \u003d \u0027Camille\u0027 AND p2.name \u003d \u0027Liam\u0027\nORDER BY num_hops\n\"\"\");",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:33.404",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 104.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "num_hops": "string",
                      "start": "string",
                      "path": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "num_hops\tstart\tpath\n3\tCamille\t[10039, 2090, Liam]"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595943157255_-1581994624",
      "id": "20200728-121543_851814387",
      "dateCreated": "2020-07-28 13:32:37.255",
      "dateStarted": "2020-07-30 00:16:33.760",
      "dateFinished": "2020-07-30 00:16:35.479",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Top-K Shortest Path (1)",
      "text": "%pgx\n// Return top 7 shortest paths starting and ending at the same account\ngraph.queryPgql(\"\"\"\n  SELECT COUNT(e) AS num_hops\n       , SUM(e.amount) AS total_amount\n       , ARRAY_AGG(e.amount) AS amounts_along_path\n    FROM MATCH TOP 7 SHORTEST ( (a:Account) -[e:transaction]-\u003e* (b:Account) )\n   WHERE a.number \u003d 10039 AND a \u003d b\nORDER BY num_hops, total_amount\n\"\"\");",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:35.481",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 366.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "num_hops": "string",
                      "total_amount": "string",
                      "amounts_along_path": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "num_hops\ttotal_amount\tamounts_along_path\n0\t0.0\tNULL\n4\t22399.8\t[1000.0, 1500.3, 9999.5, 9900.0]\n4\t23900.2\t[1000.0, 3000.7, 9999.5, 9900.0]\n8\t44799.600000000006\t[1000.0, 1500.3, 9999.5, 9900.0, 1000.0, 1500.3, 9999.5, 9900.0]\n8\t46300.0\t[1000.0, 1500.3, 9999.5, 9900.0, 1000.0, 3000.7, 9999.5, 9900.0]\n8\t46300.0\t[1000.0, 3000.7, 9999.5, 9900.0, 1000.0, 1500.3, 9999.5, 9900.0]\n8\t47800.399999999994\t[1000.0, 3000.7, 9999.5, 9900.0, 1000.0, 3000.7, 9999.5, 9900.0]"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595943157255_-1644446158",
      "id": "20200728-121544_355739833",
      "dateCreated": "2020-07-28 13:32:37.256",
      "dateStarted": "2020-07-30 00:16:35.728",
      "dateFinished": "2020-07-30 00:16:37.549",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Top-K Shortest Path (2)",
      "text": "%pgx\n// From the result above, remove zero length path and the paths visit the same edges multiple times\ngraph.queryPgql(\"\"\"\n  SELECT COUNT(e) AS num_hops\n       , SUM(e.amount) AS total_amount\n       , ARRAY_AGG(e.amount) AS amounts_along_path\n    FROM MATCH TOP 7 SHORTEST ( (a:Account) -[e:transaction]-\u003e* (b:Account) )\n   WHERE a.number \u003d 10039 AND a \u003d b AND COUNT(DISTINCT e) \u003d COUNT(e) AND COUNT(e) \u003e 0\nORDER BY num_hops, total_amount\n\"\"\");",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:37.639",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 122.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "num_hops": "string",
                      "total_amount": "string",
                      "amounts_along_path": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "num_hops\ttotal_amount\tamounts_along_path\n4\t22399.8\t[1000.0, 1500.3, 9999.5, 9900.0]\n4\t23900.2\t[1000.0, 3000.7, 9999.5, 9900.0]"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595943157256_1419526150",
      "id": "20200728-121546_290505134",
      "dateCreated": "2020-07-28 13:32:37.256",
      "dateStarted": "2020-07-30 00:16:37.761",
      "dateFinished": "2020-07-30 00:16:39.605",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Scalar subqueries",
      "text": "%pgx\n// For each person, the subquery results are collected as scalar values \ngraph.queryPgql(\"\"\"\n  SELECT p.name AS name\n       , ( SELECT SUM(t.amount)\n             FROM MATCH (a) \u003c-[t:transaction]- (:Account)\n         ) AS sum_incoming\n       , ( SELECT SUM(t.amount)\n             FROM MATCH (a) -[t:transaction]-\u003e (:Account)\n         ) AS sum_outgoing\n       , ( SELECT COUNT(DISTINCT p2)\n             FROM MATCH (a) -[t:transaction]- (:Account) \u003c-[:ownerOf]- (p2:Person)\n            WHERE p2 \u003c\u003e p\n         ) AS num_persons_transacted_with\n       , ( SELECT COUNT(DISTINCT c)\n             FROM MATCH (a) -[t:transaction]- (:Account) \u003c-[:ownerOf]- (c:Company)\n         ) AS num_companies_transacted_with\n    FROM MATCH (p:Person) -[:ownerOf]-\u003e (a:Account)\nORDER BY sum_outgoing + sum_incoming DESC\n\"\"\");",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:39.700",
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "title": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 152.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "name": "string",
                      "sum_incoming": "string",
                      "sum_outgoing": "string",
                      "num_persons_transacted_with": "string",
                      "num_companies_transacted_with": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "name\tsum_incoming\tsum_outgoing\tnum_persons_transacted_with\tnum_companies_transacted_with\nLiam\t9999.5\t9900.0\t1\t1\nCamille\t9900.0\t1000.0\t2\t0\nNikita\t1000.0\t4501.0\t1\t1"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595943157256_-253358280",
      "id": "20200728-121547_1437981992",
      "dateCreated": "2020-07-28 13:32:37.256",
      "dateStarted": "2020-07-30 00:16:39.861",
      "dateFinished": "2020-07-30 00:16:43.043",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n## Appendix\n\nSimpler examples.",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:43.078",
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eAppendix\u003c/h2\u003e\n\u003cp\u003eSimpler examples.\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595943157257_395250793",
      "id": "20200728-124156_1934077650",
      "dateCreated": "2020-07-28 13:32:37.258",
      "dateStarted": "2020-07-30 00:16:43.239",
      "dateFinished": "2020-07-30 00:16:43.338",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Shortest Path",
      "text": "%pgx\ngraph.queryPgql(\"\"\"\nSELECT COUNT(e) AS num_hops\n     , SUM(e.amount) AS total_amount\n     , ARRAY_AGG(e.amount) AS amounts_along_path\n  FROM MATCH SHORTEST ( (a:Account) -[e:transaction]-\u003e* (b:Account) )\n WHERE a.number \u003d 10039\n   AND b.number \u003d 2090\n ORDER BY num_hops, total_amount\n\n\"\"\");",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:43.463",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 88.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "num_hops": "string",
                      "total_amount": "string",
                      "amounts_along_path": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "num_hops\ttotal_amount\tamounts_along_path\n3\t12499.8\t[1000.0, 1500.3, 9999.5]"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1595948747281_266087153",
      "id": "20200728-150547_1686606161",
      "dateCreated": "2020-07-28 15:05:47.282",
      "dateStarted": "2020-07-30 00:16:43.671",
      "dateFinished": "2020-07-30 00:16:43.887",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Top K Shortest Path",
      "text": "%pgx\ngraph.queryPgql(\"\"\"\nSELECT COUNT(e) AS num_hops\n     , SUM(e.amount) AS total_amount\n     , ARRAY_AGG(e.amount) AS amounts_along_path\n  FROM MATCH TOP 3 SHORTEST ( (a:Account) -[e:transaction]-\u003e* (b:Account) )\n WHERE a.number \u003d 10039\n   AND b.number \u003d 2090\n ORDER BY num_hops, total_amount\n\n\"\"\");",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:43.983",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 144.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "num_hops": "string",
                      "total_amount": "string",
                      "amounts_along_path": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "num_hops\ttotal_amount\tamounts_along_path\n3\t12499.8\t[1000.0, 1500.3, 9999.5]\n3\t14000.2\t[1000.0, 3000.7, 9999.5]\n7\t34899.6\t[1000.0, 1500.3, 9999.5, 9900.0, 1000.0, 1500.3, 9999.5]"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596068060236_1350571669",
      "id": "20200730-001420_437116764",
      "dateCreated": "2020-07-30 00:14:20.236",
      "dateStarted": "2020-07-30 00:16:44.075",
      "dateFinished": "2020-07-30 00:16:44.348",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Cheapest Path",
      "text": "%pgx\ngraph.queryPgql(\"\"\"\nSELECT COUNT(e) AS num_hops\n     , SUM(e.amount) AS total_amount\n     , ARRAY_AGG(e.amount) AS amounts_along_path\n  FROM MATCH CHEAPEST ( (a:Account) (-[e:transaction]-\u003e COST e.amount)* (b:Account) )\n WHERE a.number \u003d 10039\n   AND b.number \u003d 2090\n ORDER BY num_hops, total_amount\n\"\"\");",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:44.374",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {
          "0": {
            "graph": {
              "mode": "table",
              "height": 88.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "num_hops": "string",
                      "total_amount": "string",
                      "amounts_along_path": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                }
              },
              "commonSetting": {}
            }
          }
        },
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "num_hops\ttotal_amount\tamounts_along_path\n3\t12499.8\t[1000.0, 1500.3, 9999.5]"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596031249079_-1635162603",
      "id": "20200729-140049_1107130858",
      "dateCreated": "2020-07-29 14:00:49.079",
      "dateStarted": "2020-07-30 00:16:44.612",
      "dateFinished": "2020-07-30 00:16:44.823",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\nEnd of Document",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:44.853",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eEnd of Document\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "jobName": "paragraph_1596030856223_-1868212460",
      "id": "20200729-135416_37105836",
      "dateCreated": "2020-07-29 13:54:16.223",
      "dateStarted": "2020-07-30 00:16:45.151",
      "dateFinished": "2020-07-30 00:16:45.160",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%md\n",
      "user": "anonymous",
      "dateUpdated": "2020-07-30 00:16:45.251",
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "editorMode": "ace/mode/markdown"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1596068116793_-923540104",
      "id": "20200730-001516_2081814783",
      "dateCreated": "2020-07-30 00:15:16.793",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Learning PGQL 3",
  "id": "2FF2QZ922",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "md:shared_process": [],
    "pgx:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {}
}